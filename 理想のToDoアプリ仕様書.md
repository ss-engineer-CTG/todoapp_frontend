# 改善版タイムラインベースToDoアプリ仕様書

## 1. コンセプト

- **タイムラインビュー中心**のToDoリストアプリ
- **直感的なGUI操作**による効率的なタスク管理
- **充実したノート機能**でタスク詳細を記録
- **柔軟なカスタマイズ**によるパーソナライズされた体験
- **将来の展望**: LLMを活用した自動報告書生成

## 2. 主要機能

### 2.1 タイムライン表示
- **表示モード切替**: 日、週単位での表示切替
- **ドラッグ＆ドロップ**: 改良された直感的なタスク期間の視覚的編集
- **ステータス表示**: タスクのステータス（遅延/進行中/未来/完了）の色分け
- **プロジェクト表示**: プロジェクトごとのグループ化
- **ズーム機能**: 表示密度の調整（50%～200%）
- **期間ナビゲーション**: 今日の日付を中心とした表示と期間移動
- **タスク詳細ポップアップ**: ホバー時に詳細情報を表示
- **表示密度調整**: 「過密表示回避モード」でタスクの重なりを自動調整
- **タスク階層表示**: プロジェクトごとの親子関係の視覚的表現と折りたたみ機能

### 2.2 タスク管理
- **タスク追加**: 複数の追加方法（クイック追加/詳細追加）
- **インライン編集**: タスク名やプロパティの直接編集
- **タスク編集**: 編集アイコンクリックで詳細編集モード
- **タスク削除**: 削除ボタン/Deleteキーでタスク削除（一括削除対応）
- **タスク完了**: Spaceキーで完了状態を切り替え（一括完了対応）
- **タスク操作**: 複製/移動（Ctrl+C, Ctrl+X, Ctrl+V）
- **一括操作**: 複数タスクの選択と一括編集/移動/削除
- **繰り返しタスク**: 日次/週次/月次/カスタム周期での繰り返し設定
- **テンプレート**: 頻繁に使用するタスクセットをテンプレート化

### 2.3 ノート機能
- タスクごとのノート機能（Ctrl+Nで起動）
- リッチテキスト編集（箇条書き、チェックリスト、リンク等）
- 画像/ファイル添付機能
- プロジェクト完了報告書の自動生成（将来機能）

### 2.4 フィルタリング
- **スマートフィルター**: 「今日の予定」「遅延タスク」などのプリセット

### 2.5 表示のカスタマイズ
- **テーマ設定**: ライトモード/ダークモード対応
- **プロジェクトカラー**: プロジェクトごとのカラーカスタマイズ（基本自動設定で後で手動変更可能）
- **表示密度**: コンパクト/標準/拡張表示の切り替え
- **フォントサイズ**: 文字サイズの調整オプション

## 3. アプリケーション構造とコンポーネント

### 3.1 タスクの構造
- **拡張データモデル**: 柔軟なタスク階層を実現する構造
- **必須データ**: タスク名、開始日、完了予定日
- **拡張データ**: 繰り返し設定、親タスクID
- **自動計算データ**: 完了日、担当者、プロジェクト名
- **オプションデータ**: タスクノート、添付ファイル

### 3.2 コンポーネント構造

#### 3.2.1 TimelineView (ルートコンポーネント)
- タイムラインビュー全体の管理
- 状態管理（表示モード、日付範囲、ズームレベル、選択中タスク等）
- 子コンポーネント間のデータフロー制御
- ドラッグ＆ドロップの状態管理
- レスポンシブレイアウト制御
- エラー処理とバリデーション

#### 3.2.2 TimelineHeader (コントロールパネル)
- 表示モード切替ボタン（日/週/月/四半期）
- 期間ナビゲーションボタン（前へ/今日/次へ）
- ズーム操作コントロール（-/+）
- 完了タスク表示切替
- ステータス凡例表示
- テーマ切替（ライト/ダーク）
- 表示密度調整
- フィルター適用状態表示

#### 3.2.3 TimelineDayHeader (日付表示)
- 月表示行の表示
- 日付表示（曜日は土日祝を色分け表示）
- 今日の日付・週末のハイライト表示
- グリッド構造の基準となる日付列
- 長期間表示時の自動密度調整

#### 3.2.4 TimelineItemList (タスク一覧)
- 複数のTimelineItemを表示するコンテナ
- タスクの選択・ドラッグ・ドロップイベント処理
- タスクの表示順序管理
- フィルタリングされたタスクの表示制御
- 過密表示自動調整ロジック
- タスク階層の折りたたみ制御

#### 3.2.5 TimelineItem[] (個別タスク)
- 個々のタスクバーの表示
- タスクの期間とステータスの視覚化
- 拡張されたドラッグ操作のハンドル提供
- ステータスとプロジェクトに応じた色分け表示
- 可変高さ対応（情報量に応じた調整）
- インライン編集インターフェース
- 繰り返しタスク表示
- 親子関係の視覚的表現

#### 3.2.6 TaskDetailPopover (詳細ポップアップ)
- タスクにホバーした際の詳細情報表示
- タスクの詳細情報の表示
- ホバー時の表示/非表示制御
- クイックアクション表示（完了/編集/削除）

#### 3.2.7 TaskEditModal (タスク編集モーダル)
- 統一されたデザインのカスタムモーダル
- タブ形式での詳細設定（基本情報/繰り返し/ノート/添付）
- リッチテキストエディタ統合
- 繰り返しタスク設定UI
- 日付入力の複数方式（カレンダー/テキスト直接入力）

#### 3.2.8 BatchOperationPanel (一括操作パネル)
- 複数選択時に表示される操作パネル
- 一括完了/削除/移動/コピー機能
- 選択数表示と操作確認UI

#### 3.2.9 TemplateManager (テンプレート管理)
- タスクテンプレートの保存/適用UI
- テンプレートリスト表示と検索
- テンプレートのインポート/エクスポート

## 4. インタラクションデザイン

### 4.1 キーボードナビゲーション（拡張版）
- **Enterキー**: 新規タスク追加（クイック入力モード起動）
- **Shift+Enter**: 詳細入力モードでタスク追加
- **Tabキー**: 子タスク追加
- **矢印キー(上/下)**: タスク間の移動
- **矢印キー(左/右)**: タスク期間の調整（微調整）
- **Shift+矢印キー(左/右)**: タスク期間の大幅調整
- **Spaceキー**: タスク完了状態の切り替え
- **Deleteキー**: タスク削除（確認ダイアログ表示）
- **Shift + 矢印キー(上/下)**: 複数タスク選択
- **+/-キー**: ズームイン/ズームアウト
- **Ctrl+N**: タスクノート起動
- **Ctrl+C/X/V**: コピー/切り取り/貼り付け
- **Ctrl+D**: タスク複製
- **Ctrl+Z/Y**: 元に戻す/やり直し
- **Ctrl+F**: 検索/フィルター
- **Ctrl+T**: テンプレート適用
- **Escape**: 現在の操作をキャンセル

### 4.2 タスク追加操作フロー（改善版）
#### 4.2.1 クイック追加モード
1. Enterキーでクイック入力フィールド表示
2. タスク名入力
3. タブキーで日付入力に移動（デフォルト値設定可）
4. 日付はテキストで直接入力可能（例: 「今日」「明日」「5/20」）
5. Enterキーで即時作成

#### 4.2.2 詳細追加モード
1. Shift+Enterキーで詳細入力ダイアログ起動
2. タブ形式で基本情報/繰り返し設定/ノート/タグを入力
3. ダイアログ内ではTabキーで項目間移動
4. 保存またはEnterキーで確定

### 4.3 インライン編集
- タスク名をダブルクリックで直接編集
- 日付をクリックで直接編集（テキスト入力/カレンダー選択）
- タスクバー上での右クリックメニューからプロパティ編集

### 4.4 拡張ドラッグ操作
- **開始日ドラッグ**: 拡大されたハンドル（8px→12px）で開始日を調整
- **終了日ドラッグ**: 拡大されたハンドルで終了日を調整
- **全体移動**: タスクバー本体で開始日と終了日を同時に調整
- **スナップ機能**: 日付グリッドに自動的にスナップ（無効化可能）
- **ドラッグプレビュー**: はっきりとした日付変更ツールチップ表示
- **スクロール自動追従**: ドラッグが画面端に達した場合の自動スクロール

### 4.5 一括操作
- **複数選択方法**:
  - Shift+クリックで範囲選択
  - Ctrl+クリックで個別選択/選択解除
  - ドラッグによる範囲選択
- **一括操作UI**: 選択時に表示される操作パネル
- **一括ドラッグ**: 選択した複数タスクの同時移動

### 4.6 繰り返しタスク設定
- **繰り返しパターン**: 日次/週次/月次/年次/カスタム
- **終了条件**: 回数指定/終了日指定/無期限
- **特殊ルール**: 営業日のみ/特定曜日のみ/N日おき等
- **例外日設定**: 特定日を除外

### 4.7 視覚的フィードバック（拡張版）
- **ホバー効果**: タスクバーが上方向に移動し、シャドウ効果が追加
- **ドラッグ中効果**: 半透明化(70%)と拡大(102%)
- **無効操作表示**: 不可能な操作時に視覚的フィードバック（赤色波動など）
- **バリデーションフィードバック**: 入力エラー時の即時フィードバック
- **カーソル変更**: 通常時はgrab、ドラッグ中はgrabbing、ハンドル部分はリサイズカーソル
- **トランジション**: アニメーション効果（0.2秒）
- **フォーカス表示**: キーボード操作時の明確なフォーカス表示

## 5. ビジュアルデザイン

### 5.1 レスポンシブデザイン
- **ブレイクポイント**: まずはデスクトップ(1024px~)のみ対応
- **デスクトップ表示**: フル機能表示

### 5.2 カラーシステム
#### 5.2.1 ベースカラー（ライトモード）
- 背景色: #F8F9FA
- コンテンツ背景: #FFFFFF
- 境界線: #E2E8F0
- テキスト(主): #333333
- テキスト(副): #6B7280

#### 5.2.2 ベースカラー（ダークモード）
- 背景色: #1A202C
- コンテンツ背景: #2D3748
- 境界線: #4A5568
- テキスト(主): #F7FAFC
- テキスト(副): #A0AEC0

#### 5.2.3 ステータスカラー（カスタマイズ可能）
- **遅延**: 背景=#FECACA, 枠線=#EF4444, テキスト=#B91C1C
- **進行中**: 背景=#BFDBFE, 枠線=#3B82F6, テキスト=#1E40AF
- **未来**: 背景=#A7F3D0, 枠線=#10B981, テキスト=#047857
- **完了**: 背景=#E5E7EB, 枠線=#9CA3AF, テキスト=#4B5563

#### 5.2.4 プロジェクトカラー
- 10種類のプリセットカラーパレット
- カスタムカラー設定機能
- プロジェクトアイコンとの組み合わせ

### 5.3 レイアウト仕様
- タイムライン行の基本高さ: 40px（可変：30px～60px）
- タスクバーの高さ: 可変（最小30px～最大60px、コンテンツ量に応じて自動調整）
- 基本スペーシング単位: 4px
- 週末と今日の日付のハイライト表示
- グリッドライン: 1px、半透明（#E2E8F0, 40%）
- カードコーナー半径: 4px

### 5.4 タイポグラフィ
- 基本フォント: システムフォント（-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu等）
- 代替フォント: サンセリフ
- 基本サイズ: 14px（調整可能：12px～18px）
- 見出しサイズ: 18px/16px/14px（h1/h2/h3）
- 行間: 1.5

### 5.5 UI要素の統一スタイル
- **ボタン**: 一貫したスタイルとサイズ（標準/小/大）
- **フォーム要素**: 統一された入力フィールド、セレクトボックス等
- **モーダル**: カスタムデザインのモーダルダイアログ（ネイティブalert不使用）
- **トースト通知**: 操作結果の一時的なフィードバック
- **アイコン**: 一貫したアイコンセット

## 6. アクセシビリティと効率化機能

### 6.1 アクセシビリティ対応
- ARIA属性の適用
- キーボード完全対応
- 色覚対応（色だけでなくアイコンでもステータスを表現）
- スクリーンリーダー対応
- 高コントラストモード
- フォントサイズ調整

### 6.2 効率化機能
#### 6.2.1 テンプレート機能
- プロジェクトテンプレート（複数タスクセット）
- タスクテンプレート（単一タスクの設定セット）
- インポート/エクスポート機能

#### 6.2.2 クイック入力
- 自然言語入力（例：「明日までにレポート作成」）
- テキスト一括処理（コピペからの複数タスク作成）
- ドラッグ＆ドロップによるファイル/テキストからのタスク生成

#### 6.2.3 自動化機能
- リマインダー設定
- 繰り返しタスクの自動生成
- タスク期限の自動調整提案

### 6.3 エラー処理と防止機能
- 入力値のリアルタイムバリデーション
- 不正な日付設定の防止（開始日>終了日等）
- 操作ミスの元に戻す/やり直し機能
- エラーメッセージの具体的な問題と解決策の表示

## 7. パフォーマンス最適化

### 7.1 データ処理
- 仮想スクロールによる大量タスク表示の最適化
- 遅延読み込みによるパフォーマンス向上
- インクリメンタルレンダリング

### 7.2 レンダリング最適化
- コンポーネントのメモ化
- 効率的な再レンダリング制御
- GPU加速アニメーション

